import{aa as T,ab as z,x as d,_ as q,am as J,$ as V,a0 as C,c as e,a1 as a,ah as L,W as I,ai as O,aj as W,a5 as s,a4 as n,J as f,a6 as v,a7 as b,a8 as G,af as H,ac as K,as as Q,ad as X,ae as Y,at as Z,a9 as ee,ak as ae,al as te}from"./index-CWikNf2Y.js";import{_ as le}from"./breadcrumbs-BaZIdevb.js";import{c as oe,a as se,u as ne,d as _,V as ie}from"./index.esm-9innt4fj.js";import{v as ue}from"./index-DWPF0MUK.js";import{V as re}from"./VContainer-DofNjeNN.js";import{V as de,a as w}from"./VRow-C0sq8wv9.js";const A=c=>(ae("data-v-a595ce87"),c=c(),te(),c),ce=["src"],me={id:"information"},pe=A(()=>n("h1",{class:"title"},"會員專區",-1)),fe={id:"btns"},ve=A(()=>n("h1",null,"上傳大頭貼",-1)),_e={__name:"profile",setup(c){const{apiAuth:B}=O(),h=z(),F=W(),$=d(null),i=q(),x=i.email,S=i.icon,D=d([{title:"寫譜專區",to:"/writtingArea",prependIcon:"mdi-pencil-box"},{title:"我的鼓譜",to:"/myScore",prependIcon:"mdi-file-document-outline"},{title:"我的收藏",to:"/mySaving",prependIcon:"mdi-content-save-all-outline"}]),u=d(!1),E=async m=>{u.value=!0,U.value.value=i.account,j.value.value=x,N.value.value=S,y.value.value=i.id},M=oe({email:se().required("使用者信箱必填").test("isEmail","使用者信箱格式錯誤",m=>ue.isEmail(m))}),{handleSubmit:R,isSubmitting:g}=ne({validationSchema:M}),U=_("account"),j=_("email"),N=_("icon"),y=_("id"),r=d([]),k=d([]),P=R(async m=>{var t,p,l;if(!((t=r.value[0])!=null&&t.error))try{const o=new FormData;r.value.length>0&&o.append("icon",r.value[0].file),await B.patch("/user/"+y.value.value,o),h({text:"編輯會員資料成功",snackbarProps:{color:"green"}}),F.go(0),u.value=!1}catch(o){console.log(o),h({text:((l=(p=o==null?void 0:o.response)==null?void 0:p.data)==null?void 0:l.message)||"發生錯誤",snackbarProps:{color:"red"}})}});return(m,t)=>{const p=J("vue-file-agent");return V(),C(I,null,[e(re,null,{default:a(()=>[e(de,null,{default:a(()=>[e(w,{cols:"12"},{default:a(()=>[e(s(le))]),_:1}),e(w,{cols:"12",md:"4",id:"col-profile"},{default:a(()=>[n("img",{src:s(S),alt:"大頭貼",id:"icon"},null,8,ce),e(f,{onClick:t[0]||(t[0]=l=>E(null)),id:"btn-edit",width:"150px",color:"",style:{margin:"auto"}},{default:a(()=>[v("上傳大頭貼")]),_:1}),n("div",me,[n("p",null,"帳號："+b(s(i).account),1),n("p",null,"email："+b(s(x)),1)])]),_:1}),e(w,{cols:"12",md:"8",id:"memberArea"},{default:a(()=>[pe,n("div",fe,[(V(!0),C(I,null,G(D.value,(l,o)=>(V(),ee(f,{key:o,to:l.to},{default:a(()=>[v(b(l.title),1)]),_:2},1032,["to"]))),128))])]),_:1})]),_:1})]),_:1}),e(L,{modelValue:u.value,"onUpdate:modelValue":t[4]||(t[4]=l=>u.value=l),width:"400"},{default:a(()=>[e(ie,{onSubmit:H(s(P),["prevent"]),disabled:s(g)},{default:a(()=>[e(K,null,{default:a(()=>[e(f,{loading:s(g),onClick:t[1]||(t[1]=l=>u.value=!1),id:"btn-close",elevation:"0"},{default:a(()=>[e(Q,null,{default:a(()=>[v(" mdi-close ")]),_:1})]),_:1},8,["loading"]),e(X,null,{default:a(()=>[ve]),_:1}),e(Y,null,{default:a(()=>[e(p,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=l=>r.value=l),"raw-model-value":k.value,"onUpdate:rawModelValue":t[3]||(t[3]=l=>k.value=l),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:$,id:"uploadPhoto"},null,8,["modelValue","raw-model-value"])]),_:1}),e(Z,{class:"justify-center"},{default:a(()=>[e(f,{color:"",type:"submit",loading:s(g)},{default:a(()=>[v("上傳")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1},8,["modelValue"])],64)}}},Se=T(_e,[["__scopeId","data-v-a595ce87"]]);export{Se as default};
