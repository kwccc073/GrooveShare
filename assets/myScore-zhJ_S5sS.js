import{aa as B,_ as I,ab as A,x as n,$ as k,a9 as f,a1 as p,c as i,a5 as U,ag as w,aq as L,J as m,ar as T,ai as K}from"./index-CWikNf2Y.js";import{_ as M}from"./breadcrumbs-BaZIdevb.js";import{V as _}from"./VContainer-DofNjeNN.js";import{V as q}from"./VDataTableServer-C5X7v7fx.js";import"./filter-CtIy9tI0.js";import"./VMenu-CByEKNdx.js";const D={__name:"myScore",setup(F){const P=I();T();const v=A(),{apiAuth:V}=K(),g=n(2),u=n([{key:"createdAt",order:"desc"}]),c=n(3),b=n([]),C=[{title:"演唱/演奏者",align:"center",sortable:!0,key:"singer"},{title:"歌名",align:"center",sortable:!0,key:"songTitle"},{title:"曲風",align:"center",sortable:!0,key:"songStyle"},{title:"BPM",align:"center",sortable:!0,key:"BPM"},{title:"公開",align:"center",sortable:!1,key:"isPublic"},{title:"",align:"center",sortable:!1,key:"action"}],y=n(!0),$=n(0),d=n(""),l=async r=>{var t,e,a,s;r&&(c.value=1),y.value=!0;try{const{data:o}=await V.get("/song/my",{params:{page:c.value,itemsPerPage:g.value,sortBy:((t=u.value[0])==null?void 0:t.key)||"createdAt",sortOrder:((e=u.value[0])==null?void 0:e.order)||"desc",search:d.value,user:P.account}});b.value.splice(0,b.value.length,...o.result.data),$.value=o.result.total}catch(o){console.log(o),v({text:((s=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:s.message)||"發生錯誤",snackbarProps:{color:"red"}})}y.value=!1};l();const x=r=>{},S=(r,t)=>{var e,a;try{P.account===t?(alert("確定要刪除歌曲嗎？"),V.delete("/song/"+r),v({text:"刪除歌曲成功",snackbarProps:{color:"green"}}),l()):alert("非原作者，無權限刪除")}catch(s){console.log(s),v({text:((a=(e=s==null?void 0:s.response)==null?void 0:e.data)==null?void 0:a.message)||"刪除歌曲發生錯誤",snackbarProps:{color:"red"}})}};return(r,t)=>(k(),f(_,null,{default:p(()=>[i(U(M)),i(q,{class:"v-data-table-server","items-per-page":g.value,"onUpdate:itemsPerPage":[t[3]||(t[3]=e=>g.value=e),t[6]||(t[6]=e=>l(!1))],"sort-by":u.value,"onUpdate:sortBy":[t[4]||(t[4]=e=>u.value=e),t[7]||(t[7]=e=>l(!1))],page:c.value,"onUpdate:page":[t[5]||(t[5]=e=>c.value=e),t[8]||(t[8]=e=>l(!1))],items:b.value,headers:C,loading:y.value,"items-length":$.value,search:d.value,hover:""},{top:p(()=>[i(w,{label:"搜尋（請輸入演唱/演奏者、歌名或曲風）",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),"append-icon":"mdi-magnify",onClickAppend:t[1]||(t[1]=e=>l(!0)),onKeydown:t[2]||(t[2]=L(e=>l(!0),["enter"]))},null,8,["modelValue"])]),"item.isPublic":p(({value:e})=>[e?(k(),f(m,{key:0,elevation:"0",icon:"mdi-lock-open-variant",onClick:a=>x(e)},null,8,["onClick"])):(k(),f(m,{key:1,elevation:"0",icon:"mdi-lock",onClick:a=>x(e)},null,8,["onClick"]))]),"item.action":p(({item:e})=>[i(m,{elevation:"0","prepend-icon":" mdi-file-eye-outline",to:"/songs/"+e._id},null,8,["to"]),i(m,{elevation:"0","prepend-icon":" mdi-trash-can-outline",onClick:a=>S(e._id,e.editor)},null,8,["onClick"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"])]),_:1}))}},j=B(D,[["__scopeId","data-v-212274fa"]]);export{j as default};
