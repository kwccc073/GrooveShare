import{aa as T,ab as z,x as d,_ as q,am as J,$ as g,a0 as k,a4 as n,c as e,a1 as a,ah as L,W as y,ai as O,aj as W,a5 as s,J as p,a6 as f,a7 as I,a8 as G,af as H,ac as K,at as Q,ad as X,ae as Y,au as Z,a9 as ee,ak as ae,al as te}from"./index-QjNOvxgV.js";import{b as oe}from"./breadcrumbs-ChhrGEHd.js";import{c as le,a as se,u as ne,d as v,V as ie}from"./index.esm-BNUcQ6WI.js";import{v as re}from"./index-DcBOdE6S.js";import{V as ue,a as V}from"./VRow-BbDlHc_g.js";import"./_commonjsHelpers-Cpj98o6Y.js";const C=c=>(ae("data-v-bc4b5db5"),c=c(),te(),c),de={id:"profile-container"},ce=["src"],me=C(()=>n("h1",{class:"title"},"會員專區",-1)),pe={id:"btns"},fe=C(()=>n("h1",null,"上傳大頭貼",-1)),ve={__name:"profile",setup(c){const{apiAuth:A}=O(),w=z(),B=W(),F=d(null),i=q(),$=i.email,h=i.icon,D=d([{title:"寫譜專區",to:"/writtingArea",prependIcon:"mdi-pencil-box"},{title:"我的鼓譜",to:"/myScore",prependIcon:"mdi-file-document-outline"},{title:"我的收藏",to:"/mySaving",prependIcon:"mdi-content-save-all-outline"}]),r=d(!1),E=async()=>{r.value=!0,U.value.value=i.account,j.value.value=$,N.value.value=h,x.value.value=i.id},M=le({email:se().required("使用者信箱必填").test("isEmail","使用者信箱格式錯誤",b=>re.isEmail(b))}),{handleSubmit:R,isSubmitting:_}=ne({validationSchema:M}),U=v("account"),j=v("email"),N=v("icon"),x=v("id"),u=d([]),S=d([]),P=R(async b=>{var t,m,o;if(!((t=u.value[0])!=null&&t.error))try{const l=new FormData;u.value.length>0&&l.append("icon",u.value[0].file),await A.patch("/user/"+x.value.value,l),w({text:"上傳大頭貼成功",snackbarProps:{color:"green"}}),B.go(0),r.value=!1}catch(l){console.log(l),w({text:((o=(m=l==null?void 0:l.response)==null?void 0:m.data)==null?void 0:o.message)||"發生錯誤",snackbarProps:{color:"red"}})}});return(b,t)=>{const m=J("vue-file-agent");return g(),k(y,null,[n("div",de,[e(ue,null,{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[e(s(oe))]),_:1}),e(V,{cols:"12",md:"4",id:"col-profile"},{default:a(()=>[n("img",{src:s(h),alt:"大頭貼",id:"icon"},null,8,ce),e(p,{onClick:t[0]||(t[0]=o=>E(null)),id:"btn-edit",width:"150px",color:"black",style:{margin:"auto"}},{default:a(()=>[f("上傳大頭貼")]),_:1}),n("div",null,I(s(i).account),1)]),_:1}),e(V,{cols:"12",md:"8",id:"memberArea"},{default:a(()=>[me,n("div",pe,[(g(!0),k(y,null,G(D.value,(o,l)=>(g(),ee(p,{key:l,to:o.to},{default:a(()=>[f(I(o.title),1)]),_:2},1032,["to"]))),128))])]),_:1})]),_:1})]),e(L,{modelValue:r.value,"onUpdate:modelValue":t[4]||(t[4]=o=>r.value=o),width:"400"},{default:a(()=>[e(ie,{onSubmit:H(s(P),["prevent"]),disabled:s(_)},{default:a(()=>[e(K,null,{default:a(()=>[e(p,{loading:s(_),onClick:t[1]||(t[1]=o=>r.value=!1),id:"btn-close",elevation:"0"},{default:a(()=>[e(Q,null,{default:a(()=>[f(" mdi-close ")]),_:1})]),_:1},8,["loading"]),e(X,null,{default:a(()=>[fe]),_:1}),e(Y,null,{default:a(()=>[e(m,{modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=o=>u.value=o),"raw-model-value":S.value,"onUpdate:rawModelValue":t[3]||(t[3]=o=>S.value=o),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:F,id:"uploadPhoto"},null,8,["modelValue","raw-model-value"])]),_:1}),e(Z,{class:"justify-center"},{default:a(()=>[e(p,{color:"",type:"submit",loading:s(_)},{default:a(()=>[f("上傳")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1},8,["modelValue"])],64)}}},xe=T(ve,[["__scopeId","data-v-bc4b5db5"]]);export{xe as default};
