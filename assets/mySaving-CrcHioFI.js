import{aa as V,_ as $,ab as w,x as l,$ as A,a0 as I,c as o,a5 as U,a1 as k,W as C,ag as L,ar as T,J as P,aj as F,ai as K}from"./index-XyiB-VB6.js";import{b as M}from"./breadcrumbs-BOr8lFpk.js";import{V as j}from"./VDataTableServer-Bk-u80Ye.js";import"./filter-CkWNPgze.js";import"./VMenu-DSmxjhRy.js";const D={__name:"mySaving",setup(E){const g=$();F();const b=w(),{apiAuth:S}=K(),v=l(10),n=l([{key:"createdAt",order:"desc"}]),r=l(1),i=l([]),x=[{title:"演唱/演奏者",align:"center",sortable:!0,key:"singer"},{title:"歌名",align:"center",sortable:!0,key:"songTitle"},{title:"曲風",align:"center",sortable:!0,key:"songStyle"},{title:"BPM",align:"center",sortable:!0,key:"BPM"},{title:"建立者",align:"center",sortable:!1,key:"editor"},{title:"",align:"center",sortable:!1,key:"action"}],p=l(!0),y=l(0),u=l(""),s=async d=>{var e,t,m,f;d&&(r.value=1),p.value=!0;try{const{data:a}=await S.get("/user/saving",{params:{page:r.value,itemsPerPage:v.value,sortBy:((e=n.value[0])==null?void 0:e.key)||"createdAt",sortOrder:((t=n.value[0])==null?void 0:t.order)||"desc",search:u.value,user:g.account}});i.value.splice(0,i.value.length,...a.result[0]),console.log(i.value.length),console.log(a.result[0]),y.value=a.result[1],console.log(a.result)}catch(a){console.log(a),b({text:((f=(m=a==null?void 0:a.response)==null?void 0:m.data)==null?void 0:f.message)||"發生錯誤",snackbarProps:{color:"red"}})}p.value=!1};s();const c=l(!1),B=async d=>{if(!g.isLogin){alert("請先登入帳號");return}c.value=!0;const e=await g.saveSong(d);b({text:e.text,snackbarProps:{color:e.color}}),c.value=!1,s()};return(d,e)=>(A(),I(C,null,[o(U(M)),o(j,{id:"table","items-per-page":v.value,"onUpdate:itemsPerPage":[e[3]||(e[3]=t=>v.value=t),e[6]||(e[6]=t=>s(!1))],"sort-by":n.value,"onUpdate:sortBy":[e[4]||(e[4]=t=>n.value=t),e[7]||(e[7]=t=>s(!1))],page:r.value,"onUpdate:page":[e[5]||(e[5]=t=>r.value=t),e[8]||(e[8]=t=>s(!1))],items:i.value,headers:x,loading:p.value,"items-length":y.value,search:u.value,hover:""},{top:k(()=>[o(L,{label:"搜尋（請輸入演唱/演奏者、歌名或曲風）",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),"append-icon":"mdi-magnify",onClickAppend:e[1]||(e[1]=t=>s(!0)),onKeydown:e[2]||(e[2]=T(t=>s(!0),["enter"]))},null,8,["modelValue"])]),"item.action":k(({item:t})=>[o(P,{elevation:"0","prepend-icon":" mdi-cards-heart",onClick:m=>B(t._id),loading:c.value},null,8,["onClick","loading"]),o(P,{elevation:"0","prepend-icon":" mdi-file-eye-outline",to:"/songs/"+t._id},null,8,["to"])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"])],64))}},W=V(D,[["__scopeId","data-v-9593cd2c"]]);export{W as default};
