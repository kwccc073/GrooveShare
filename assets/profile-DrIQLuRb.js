import{aa as T,ab as z,x as r,_ as q,am as J,$ as V,a0 as k,c as e,a1 as a,ah as L,W as y,ai as O,aj as W,a5 as s,a4 as d,J as f,a6 as v,a7 as C,a8 as G,af as H,ac as K,as as Q,ad as X,ae as Y,at as Z,a9 as ee,ak as ae,al as te}from"./index-tF3WnsXk.js";import{b as le}from"./breadcrumbs-BrApQjfA.js";import{c as oe,a as se,u as ne,d as _,V as ie}from"./index.esm-IVbycjaY.js";import{v as ue}from"./index-DS2l_wEO.js";import{V as re}from"./VContainer-D5TUeCIK.js";import{V as de,a as b}from"./VRow-BxydngYz.js";const I=c=>(ae("data-v-eae2cf0a"),c=c(),te(),c),ce=["src"],me=I(()=>d("h1",{class:"title"},"會員專區",-1)),pe={id:"btns"},fe=I(()=>d("h1",null,"上傳大頭貼",-1)),ve={__name:"profile",setup(c){const{apiAuth:A}=O(),w=z(),B=W(),F=r(null),n=q(),$=n.email,x=n.icon,D=r([{title:"寫譜專區",to:"/writtingArea",prependIcon:"mdi-pencil-box"},{title:"我的鼓譜",to:"/myScore",prependIcon:"mdi-file-document-outline"},{title:"我的收藏",to:"/mySaving",prependIcon:"mdi-content-save-all-outline"}]),i=r(!1),E=async m=>{i.value=!0,U.value.value=n.account,j.value.value=$,N.value.value=x,h.value.value=n.id},M=oe({email:se().required("使用者信箱必填").test("isEmail","使用者信箱格式錯誤",m=>ue.isEmail(m))}),{handleSubmit:R,isSubmitting:g}=ne({validationSchema:M}),U=_("account"),j=_("email"),N=_("icon"),h=_("id"),u=r([]),S=r([]),P=R(async m=>{var t,p,l;if(!((t=u.value[0])!=null&&t.error))try{const o=new FormData;u.value.length>0&&o.append("icon",u.value[0].file),await A.patch("/user/"+h.value.value,o),w({text:"編輯會員資料成功",snackbarProps:{color:"green"}}),B.go(0),i.value=!1}catch(o){console.log(o),w({text:((l=(p=o==null?void 0:o.response)==null?void 0:p.data)==null?void 0:l.message)||"發生錯誤",snackbarProps:{color:"red"}})}});return(m,t)=>{const p=J("vue-file-agent");return V(),k(y,null,[e(re,null,{default:a(()=>[e(de,null,{default:a(()=>[e(b,{cols:"12"},{default:a(()=>[e(s(le))]),_:1}),e(b,{cols:"12",md:"4",id:"col-profile"},{default:a(()=>[d("img",{src:s(x),alt:"大頭貼",id:"icon"},null,8,ce),e(f,{onClick:t[0]||(t[0]=l=>E(null)),id:"btn-edit",width:"150px",color:"black",style:{margin:"auto"}},{default:a(()=>[v("上傳大頭貼")]),_:1}),d("div",null,C(s(n).account),1)]),_:1}),e(b,{cols:"12",md:"8",id:"memberArea"},{default:a(()=>[me,d("div",pe,[(V(!0),k(y,null,G(D.value,(l,o)=>(V(),ee(f,{key:o,to:l.to},{default:a(()=>[v(C(l.title),1)]),_:2},1032,["to"]))),128))])]),_:1})]),_:1})]),_:1}),e(L,{modelValue:i.value,"onUpdate:modelValue":t[4]||(t[4]=l=>i.value=l),width:"400"},{default:a(()=>[e(ie,{onSubmit:H(s(P),["prevent"]),disabled:s(g)},{default:a(()=>[e(K,null,{default:a(()=>[e(f,{loading:s(g),onClick:t[1]||(t[1]=l=>i.value=!1),id:"btn-close",elevation:"0"},{default:a(()=>[e(Q,null,{default:a(()=>[v(" mdi-close ")]),_:1})]),_:1},8,["loading"]),e(X,null,{default:a(()=>[fe]),_:1}),e(Y,null,{default:a(()=>[e(p,{modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=l=>u.value=l),"raw-model-value":S.value,"onUpdate:rawModelValue":t[3]||(t[3]=l=>S.value=l),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:F,id:"uploadPhoto"},null,8,["modelValue","raw-model-value"])]),_:1}),e(Z,{class:"justify-center"},{default:a(()=>[e(f,{color:"",type:"submit",loading:s(g)},{default:a(()=>[v("上傳")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1},8,["modelValue"])],64)}}},he=T(ve,[["__scopeId","data-v-eae2cf0a"]]);export{he as default};
